<include file='Common:top'/>
<script type="text/javascript" src="__PUBLIC__/Js/addArticle.js"></script>
<script type="text/javascript" charset="utf-8" src="__ROOT__/Public/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__ROOT__/Public/ueditor/ueditor.all.min.js"> </script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="__ROOT__/Public/ueditor/lang/zh-cn/zh-cn.js"></script>
</head>
<body>
<div class="template">
    <div class="template_top">
        <div class="template_top_left">
            <h1>帖子管理>发布文贴</h1>
        </div>
        <div class="template_top_right">
            <a href="{:U('Admin/Topic/index')}" class="ul_button">返回</a>
        </div>
        <div class="fn-clear"></div>
    </div>
    <div class="add">
    
    <form name="adminForm" class="js-form" action="{:U('Admin/Topic/addArticleHandle')}" method="post" enctype="multipart/form-data">
        <ul class="add_blank">                       
            <li><div class="blank_left">标题</div><div class="blank_right"><input style="width:100%;height:35px;" type="text" class="js-title" name="title" /></div><div class="fn-clear"></div></li>
            <li><div class="blank_left">作者</div><div class="blank_right"><input style="width:100%;height:35px;" type="text" class="js-author" name="author" /></div><div class="fn-clear"></div></li>
            <li><div class="blank_left">图片</div><div class="blank_right"><input style="width:100%;height:35px;" type="file" class="js-picture" name="picture" /></div><div class="fn-clear"></div></li>
            <li><div class="blank_left">摘要</div><div class="blank_right"><textarea name="intro" class="js-intro" style="width:100%;height:80px;">{$topic.intro}</textarea></div><div class="fn-clear"></div></li>
            <li><div class="blank_left">正文</div><div class="blank_right"> <script id="editor" name="content" type="text/plain">{$topic.content}</script></div><div class="fn-clear"></div></li>
            <li><div class="blank_left">权重</div><div class="blank_right"><input type="number" value="{$topic.weight}" name="weight" /><span style="color:red;">值越大越靠前显示</span></div><div class="fn-clear"></div></li>
            <li><div class="blank_left"><span class="blank_color">*</span>状态</div><div class="blank_right">
            <input type="radio" name="status" value="1"  class="ul_middle" checked/>&nbsp;正常&nbsp;&nbsp;
            <input type="radio" name="status" value="0" class="ul_middle" />&nbsp;屏蔽
            </div><div class="fn-clear"></div></li>
            
            <li><div class="blank_left"><span class="blank_color">*</span>热门</div><div class="blank_right">
            <input type="radio" name="ispush" value="1"  class="ul_middle"/>&nbsp;是&nbsp;&nbsp;
            <input type="radio" name="ispush" value="0" class="ul_middle" checked/>&nbsp;否
            </div><div class="fn-clear"></div></li>
            <li><div class="blank_left"><span class="blank_color">*</span>类型</div><div class="blank_right">
                <select name="type">
                <!--<option value =''>选择分类</option>-->
                <option value =1 selected>主题文贴</option>
                <option value =3>培训咨询</option>
              </select>
            </div><div class="fn-clear"></div></li>
            <!--<input type="hidden" name="type" value=1 />-->
            <li class="ul_word"><input type="button" class="ul_add js-sub" value="保存"/><input type="button" class="ul_cancel" onclick="history.go(-1);"  value="取消"/></li>
        </ul></form>
    </div>
</div>
<script>
    var width = $(window).width();
    if(width>768){
        var ue = new UE.ui.Editor({initialFrameHeight:500});
        ue.render('editor');
//        var ue = UE.getEditor('editor');
    }else{
        var ue = UE.getEditor('editor',{
            //这里可以选择自己需要的工具按钮名称,此处仅选择如下五个
            initialFrameHeight:200,toolbars:[['FullScreen','bold','underline','forecolor','simpleupload','fontsize','test']]
            //focus时自动清空初始化时的内容
//        autoClearinitialContent:true,
//        //关闭字数统计
//        wordCount:false,
//        //关闭elementPath
//        elementPathEnabled:false,
//        //默认的编辑区域高度
//        initialFrameHeight:300
            //更多其他参数，请参考ueditor.config.js中的配置项
        });
    }
    $(function(){
        $('.js-sub').click(function(){
            var title = $(".js-title").val();
            var author = $(".js-author").val();
            var intro = $(".js-intro").val();
            var picture = $(".js-picture").val();
            var type=$(".js-type").val();
            var content = ue.hasContents();
            var flag = true;
            var msg = '';
            if(title == ''){
//                alert("标题不能为空");
                flag = false;
                msg+="标题不能为空,";
//                return false;
            }
            if(intro == ''){
//                alert("简介不能为空");
                flag = false;
                msg+="简介不能为空,";
//                return false;
            }
            if(author == ''){
//                alert("简介不能为空");
                flag = false;
                msg+="作者不能为空,";
//                return false;
            }
            if(picture == ''){
//                alert("图片不能为空");
                msg+="图片不能为空,";
                flag = false;
//                return false;
            }
            if(type == ''){
//                alert("类型不能为空");
                msg+="类型不能为空,";
                flag = false;
//                return false;
            }
            if(!content){
//                alert("内容不能为空");
                msg+="内容不能为空,";
                flag = false;
//                return false;
            }

            if(flag){
                $(".js-form").submit();
            }else{
                msg = msg.replace(/(^,*)|(,*$)/g,'');
                alert(msg);
                return false;
            }
        });
    });
</script>
</body>
</html>