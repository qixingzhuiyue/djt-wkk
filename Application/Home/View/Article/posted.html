<include file="Public/header"/>
    <link rel="stylesheet" href="__PUBLIC__/styles/posted.css">
<script type="text/javascript" charset="utf-8" src="__ROOT__/Public/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__ROOT__/Public/ueditor/ueditor.all.min.js"></script>
    <title>发布帖子</title>
</head>
<body>
<!--//发布帖子posted-->
<div class="mainBg">
    <!--header登录注册-->
    <include file="Public/top"/>
    <!--header logo end-->
    <!--导航条-->
   <include file="Public/nav"/>
    <!--导航条 end-->
    <!--发表帖子-->
  <div class="content bgwh">
      <form action="{:U('Home/Article/posted')}" method="post" enctype="multipart/form-data" class="js-form">
      <h3 class="g9a">发表文贴</h3>
      <div class="title">
          <label for="title">文贴标题 </label>
          <input id="title" value="{$article.title}" class="js-title" name="title" type="text">
      </div>
          <br/>
          <div class="type">
              <label >文贴类型 </label>
              <input class="typeBest rel dib" value="0" <if condition="$article.ispush neq 1">checked</if>  name="ispush" type="radio">
             <input class="typeHot rel dib"  value="1" <if condition="$article.ispush eq 1">checked</if>  name="ispush" type="radio">
          </div>
          <div class="intro">
              <label for="intro">文贴介绍</label>
              <textarea id="intro" cols="6" rows="6" class="js-intro" name="intro">{$article.intro}</textarea>
          </div>
          <div>
              <label>上传图片 </label>
              <div class="dib upImgT fn-clear">
                  <if condition="$article.picture eq ''">
                      <lable class="l imgDiv" id="imgDiv"><img  class="showImg" id="showImg" /></lable>
                      <else/>
                      <lable class="l imgDiv" id="logoDiv"><img src="__PUBLIC__{$article.picture}"  class="showImg" id="showImg" /></lable>
                  </if>
                  <div class="l f12 upImgTitle required">
                      <p class="g8c hidden-xs">图片不得大于4M (jpg、gif、png、bmp)</p>
                      <p class="g8c hidden-xs"> 推荐尺寸 472*280 px的图片</p>
                      <div class="up_img rel">
                          <input class="abs" name="picture" type="file" id="img_up" value="上传"/>
                          <label class="abs img_up f18 wh b9a" >上传</label>
                      </div>
                  </div>
              </div>
          </div>
          <script class="js-content" id="editor" name="content" type="text/plain">{$article.content}</script>
      <!--<textarea  name="content"></textarea>-->
      <!--<span>确认信息填写完整方可提交</span>-->
          <input type="hidden" class="js-id" value="{$article.articleid}" name="id"/>
      <a href="javascript:;"><input class="b9a wh js-sub" type="button" value="发表帖子"></a>
      </form>
  </div>
    <!--发表帖子 end-->
</div>
<!--底部导航&footer-->
<include file="Public/footer3"/>
<!--底部导航&footer end-->
<!--共用js-->
<script src="__PUBLIC__/scripts/base.js"></script>
<script src="__PUBLIC__/scripts/bootstrap.min.js"></script>
<script src="__PUBLIC__/scripts/uploadPreview.js" ></script>
<script>
    var width = $(window).width();
    if(width>768){
        var ue = new UE.ui.Editor({initialFrameHeight:500});
        ue.render('editor');
//        var ue = UE.getEditor('editor');
    }else{
        var ue = UE.getEditor('editor',{
            //这里可以选择自己需要的工具按钮名称,此处仅选择如下五个
            initialFrameHeight:200,toolbars:[['FullScreen','bold','underline','forecolor','simpleupload','fontsize','test']]
            //focus时自动清空初始化时的内容
//        autoClearinitialContent:true,
//        //关闭字数统计
//        wordCount:false,
//        //关闭elementPath
//        elementPathEnabled:false,
//        //默认的编辑区域高度
//        initialFrameHeight:300
            //更多其他参数，请参考ueditor.config.js中的配置项
        });
    }
</script>
<script>
    $(document).ready(function () {
        // nav
        $(".navbar-nav li:nth-child(6)").mouseout(function () {
            $(this).addClass('listBg') ;
        });
        //表单提交
        $(".js-sub").click(function(){
            var title = $(".js-title").val();
            var intro = $(".js-intro").val();
            var picture = $(".js-picture").val();
            var content = ue.hasContents();
            var id = $(".js-id").val();
            var flag = true;
            if(id==''){
                if(title == ''){
                    alert("标题不能为空");
                    flag = false;
                    return false;
                }
                if(intro == ''){
                    alert("简介不能为空");
                    flag = false;
                    return false;
                }
                if(picture == ''){
                    alert("图片不能为空");
                    flag = false;
                    return false;
                }
                if(!content){
                    alert("内容不能为空");
                    flag = false;
                    return false;
                }
            }
            if(flag){
                $(".js-form").submit();
            }
        });
        // 上传图片预览
        window.onload = function () {
            new uploadPreview({UpBtn: "img_up", DivShow: "imgDiv", ImgShow: "showImg"});
        };
    })
</script>
</body>
</html>